# Requirements: Swipe App Onboarding

**Version:** 1.0
**Status:** REVIEW
**Last Updated:** 2026-02-02

---

## Problem Statement

Пользователи приложения Deal Detective имеют разный уровень опыта и разные цели:
- **Beginners** хотят быстро начать искать foreclosures без сложных настроек
- **Experts** хотят настроить фокус под свою специализацию (строительство, мебель, авто)

Онбординг должен:
1. Позволить пропустить в любой момент (для returning users)
2. Собрать минимум данных для персонализации
3. Научить базовым жестам через практику
4. Настроить географический фокус (штат/county)

---

## User Stories

### US-1: Skip Onboarding (Best Practice)

**As a** returning user или нетерпеливый пользователь
**I want** пропустить онбординг сразу с Welcome экрана
**So that** я могу начать использовать приложение немедленно

**Acceptance Criteria:**
- [ ] Кнопка "Пропустить" видна на Welcome экране
- [ ] Кнопка "Пропустить" доступна на каждом экране онбординга
- [ ] При skip устанавливаются defaults: Beginner mode, поиск везде
- [ ] Пользователь попадает сразу на главный экран с карточками

---

### US-2: Mode Selection

**As a** новый пользователь
**I want** выбрать между простым и экспертным режимом
**So that** интерфейс соответствует моему уровню

**Acceptance Criteria:**
- [ ] Два варианта: "Простой" (Beginner) и "Эксперт" (Advanced)
- [ ] Анимированные превью показывают разницу в жестах
- [ ] Beginner: горизонтальный свайп (Tinder-style)
- [ ] Expert: 4-way навигация + annotation tools
- [ ] Выбор сохраняется в `UserPreferences.swipeMode`

---

### US-3: Role Selection (Expert Only) - The Lens

**As an** Expert пользователь
**I want** выбрать свою специализацию
**So that** AI адаптирует фокус под мои интересы

**Roles:**
| Role | Фокус | Примеры |
|------|-------|---------|
| Строитель | Структура | Крыша, фундамент, стены |
| Мебель | Интерьер | Антикварная мебель, реставрация |
| Авто/Наука | Гараж, история | Ретро-авто, научные приборы |
| Инвестор | ROI | Foreclosure %, риски |
| Для семьи | Район | Школы, безопасность |
| Универсальный | Всё | Без специфического фокуса |

**Acceptance Criteria:**
- [ ] Экран показывается ТОЛЬКО для Expert mode
- [ ] 6 вариантов ролей + "Универсальный"
- [ ] Выбор сохраняется в `UserPreferences.role`
- [ ] AI использует роль для приоритизации контента

---

### US-4: Geography Selection

**As a** пользователь
**I want** выбрать где искать properties
**So that** вижу релевантные foreclosures

**Geography Options:**
1. **Auto-detect** - определяем по IP/геолокации, предлагаем ближайшие штаты
2. **Выбор штата** - пользователь выбирает 1+ штатов
3. **Выбор county** - более точный выбор внутри штата
4. **Искать везде** - без географического фильтра

**Acceptance Criteria:**
- [ ] Auto-detect работает при наличии разрешения на геолокацию
- [ ] Показываем 2-3 ближайших штата с краткой инфой (тип: Lien/Deed, %)
- [ ] Поиск по названию штата/county
- [ ] "Популярные" quick-select: Arizona, Florida, Texas, South Dakota
- [ ] Опция "Искать везде" для тех кто не хочет ограничивать
- [ ] Если выбран штат → опционально предлагаем выбрать counties
- [ ] Сохраняется в `UserPreferences.states[]` и `UserPreferences.counties[]`

---

### US-5: County Selection (Optional)

**As a** пользователь выбравший конкретный штат
**I want** уточнить counties
**So that** фокусируюсь на конкретной области

**Acceptance Criteria:**
- [ ] Показывается ТОЛЬКО если пользователь выбрал штат (не "везде")
- [ ] Опция "Весь штат" выбрана по умолчанию
- [ ] Список counties с количеством liens
- [ ] Multi-select для нескольких counties
- [ ] Можно пропустить (останется весь штат)

---

### US-6: Mini-Tutorial

**As a** новый пользователь
**I want** попрактиковать свайпы на демо-карточках
**So that** понимаю как работает интерфейс

**Beginner Tutorial (2 шага):**
1. Свайп вправо → "Интересно" (Like)
2. Свайп влево → "Пропустить" (Pass)

**Expert Tutorial (3 шага):**
1. Свайп вправо → детали/интерьер
2. Свайп влево → контекст/история
3. Long press → annotation mode demo

**Acceptance Criteria:**
- [ ] Демо-карточки с реальными данными (или убедительными примерами)
- [ ] Показываем foreclosure % на карточках
- [ ] Нельзя продолжить пока не выполнен жест (или skip)
- [ ] Визуальные подсказки (стрелки, анимация руки)
- [ ] Progress indicator (1/2, 2/2)

---

### US-7: Ready Screen

**As a** пользователь завершивший онбординг
**I want** видеть сводку моих настроек
**So that** понимаю что система готова

**Acceptance Criteria:**
- [ ] Показываем: регион, количество доступных properties, foreclosures
- [ ] Совет/подсказка по использованию
- [ ] Кнопка "Начать поиск" ведёт на главный экран
- [ ] Настройки можно изменить позже в Settings

---

## Flows

### Beginner Flow
```
Welcome (Skip ✓)
    ↓
Mode Selection → "Простой"
    ↓
География (auto-detect + выбор)
    ↓
[County selection - опционально]
    ↓
Mini-Tutorial (2 свайпа)
    ↓
Ready → Main App
```

### Expert Flow
```
Welcome (Skip ✓)
    ↓
Mode Selection → "Эксперт"
    ↓
Role Selection (The Lens)
    ↓
География (auto-detect + выбор)
    ↓
[County selection - опционально]
    ↓
Mini-Tutorial (3 шага + annotation)
    ↓
Ready → Main App
```

### Skip Flow
```
Welcome → Skip
    ↓
Main App (defaults: Beginner, поиск везде)
```

---

## Wireframes

### Screen 1: Welcome + Skip
```
┌─────────────────────────────────────────────────────────────┐
│                                        [ Пропустить → ]    │
│                                                             │
│                                                             │
│                         🏠                                  │
│                                                             │
│                   DEAL DETECTIVE                            │
│                                                             │
│              Найдите foreclosure properties                │
│                   по лучшей цене                            │
│                                                             │
│                                                             │
│                                                             │
│              ┌─────────────────────────┐                    │
│              │    🔍 Начать настройку  │                    │
│              └─────────────────────────┘                    │
│                                                             │
│              ─────── или ───────                            │
│                                                             │
│              [ Я уже знаю как свайпать ]                   │
│                     ↓ сразу в app                           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Screen 2: Mode Selection
```
┌─────────────────────────────────────────────────────────────┐
│  ←                                        [ Пропустить ]   │
│                                                             │
│                  Как хотите искать?                         │
│                                                             │
│   ┌─────────────────────────────────────────────────────┐  │
│   │                                                     │  │
│   │         ← 👎          [CARD]          👍 →          │  │
│   │                    (анимация)                       │  │
│   │                                                     │  │
│   │                    ПРОСТОЙ                          │  │
│   │                                                     │  │
│   │       Свайп влево/вправо как в Tinder              │  │
│   │       Быстро отфильтровать foreclosures            │  │
│   │                                                     │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
│   ┌─────────────────────────────────────────────────────┐  │
│   │                                                     │  │
│   │    ← Контекст    │  CARD  │    Детали →            │  │
│   │                  ↑↓                                 │  │
│   │                                                     │  │
│   │                    ЭКСПЕРТ                          │  │
│   │                                                     │  │
│   │       4 направления + разметка фото                │  │
│   │       Глубокий анализ для инвесторов               │  │
│   │                                                     │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Screen 3: Role Selection (Expert Only)
```
┌─────────────────────────────────────────────────────────────┐
│  ←                                        [ Пропустить ]   │
│                                                             │
│                  Ваша специализация?                        │
│                                                             │
│        (AI адаптирует фокус под ваш профиль)               │
│                                                             │
│   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐        │
│   │   👷        │  │   🛋️        │  │   🚗        │        │
│   │  Строитель  │  │  Мебель     │  │ Авто/Наука  │        │
│   │ структура,  │  │ интерьер,   │  │ гараж,      │        │
│   │ крыша       │  │ антиквариат │  │ история     │        │
│   └─────────────┘  └─────────────┘  └─────────────┘        │
│                                                             │
│   ┌─────────────┐  ┌─────────────┐                         │
│   │   💰        │  │   🏠        │                         │
│   │  Инвестор   │  │  Для семьи  │                         │
│   │ ROI, риски, │  │ район,      │                         │
│   │ foreclosure │  │ школы       │                         │
│   └─────────────┘  └─────────────┘                         │
│                                                             │
│               [ Универсальный профиль ]                     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Screen 4: Geography Selection
```
┌─────────────────────────────────────────────────────────────┐
│  ←                                        [ Пропустить ]   │
│                                                             │
│                  Где искать properties?                     │
│                                                             │
│   ┌─────────────────────────────────────────────────────┐  │
│   │  📍 Рядом с вами (auto-detected)                    │  │
│   │                                                     │  │
│   │     ✓  Arizona (Tax Lien, 16%, Feb auction)        │  │
│   │     ○  Utah (Tax Deed, May auction)                │  │
│   │     ○  Nevada (Tax Deed)                           │  │
│   │                                                     │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
│   ───────── или выберите вручную ─────────                  │
│                                                             │
│   ┌─────────────────────────────────────────────────────┐  │
│   │  🔍 Поиск штата или county...                       │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
│   Популярные:                                               │
│   [ Arizona ]  [ Florida ]  [ Texas ]  [ South Dakota ]    │
│                                                             │
│   ┌─────────────────────────────────────────────────────┐  │
│   │     🌎  Искать везде                               │  │
│   │        (система сама ранжирует по foreclosure)     │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
│              ┌─────────────────────────┐                    │
│              │       Продолжить        │                    │
│              └─────────────────────────┘                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Screen 4.1: County Selection (Optional)
```
┌─────────────────────────────────────────────────────────────┐
│  ←  Arizona                               [ Пропустить ]   │
│                                                             │
│              Какие counties интересуют?                     │
│                                                             │
│   ┌─────────────────────────────────────────────────────┐  │
│   │  ✓ Весь штат Arizona                               │  │
│   └─────────────────────────────────────────────────────┘  │
│                                                             │
│   ───────── или конкретные counties ─────────               │
│                                                             │
│   ┌────────────────┐  ┌────────────────┐                   │
│   │ ✓ Maricopa    │  │ ○ Pima         │                   │
│   │   Phoenix      │  │   Tucson       │                   │
│   │   12,450 liens │  │   3,200 liens  │                   │
│   └────────────────┘  └────────────────┘                   │
│                                                             │
│   ┌────────────────┐  ┌────────────────┐                   │
│   │ ○ Pinal       │  │ ○ Yavapai      │                   │
│   │   Casa Grande  │  │   Prescott     │                   │
│   │   2,100 liens  │  │   1,800 liens  │                   │
│   └────────────────┘  └────────────────┘                   │
│                                                             │
│              ┌─────────────────────────┐                    │
│              │       Продолжить        │                    │
│              └─────────────────────────┘                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Screen 5: Mini-Tutorial (Beginner)
```
┌─────────────────────────────────────────────────────────────┐
│                                           [ Пропустить ]   │
│                                                             │
│                  Попробуйте! (1/2)                          │
│                                                             │
│            Свайпните ВПРАВО на интересное                  │
│                                                             │
│        ┌────────────────────────────────────────┐          │
│        │                                        │          │
│        │    ╭──────────────────────────────╮    │          │
│        │    │  [🏠 Property Photo]         │    │          │
│        │    │                              │    │          │
│        │    │  Phoenix, AZ                 │ →  │          │
│        │    │  Foreclosure: 85%            │ 👍 │          │
│        │    │  Lien: $320                  │    │          │
│        │    │                              │    │          │
│        │    ╰──────────────────────────────╯    │          │
│        │                                        │          │
│        └────────────────────────────────────────┘          │
│                                                             │
│                👆 Свайпните вправо                          │
│                                                             │
│                       ○ ○                                   │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Screen 6: Ready
```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│                         ✅                                   │
│                                                             │
│                   Готово к поиску!                          │
│                                                             │
│         ┌───────────────────────────────────────┐          │
│         │                                       │          │
│         │   📍 Регион:    Arizona               │          │
│         │   🎯 Counties:  Maricopa, Pinal       │          │
│         │   📊 Доступно:  15,650 properties     │          │
│         │   🔥 Foreclosures: 2,340              │          │
│         │                                       │          │
│         └───────────────────────────────────────┘          │
│                                                             │
│         💡 Совет: Тапните на карточку                      │
│            чтобы увидеть детали                             │
│                                                             │
│              ┌─────────────────────────┐                    │
│              │    🔍 Начать поиск      │                    │
│              └─────────────────────────┘                    │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## Constraints

- **Technical:** Flutter, GoRouter для навигации
- **Platform:** iOS, Android
- **Dependencies:**
  - `UserPreferences` model
  - Gateway API для списка штатов/counties
  - Geolocation permission (optional)

---

## Out of Scope (This Iteration)

- Регистрация/логин (отдельный flow)
- Push notification permissions
- Интеграция с Apple/Google Sign-In
- A/B тестирование вариантов онбординга

---

## Open Questions

- [x] Skip на каждом экране или только на Welcome? → **На каждом экране**
- [x] Beginner нужен Role Selection? → **Нет, только для Expert**
- [x] Как работает география? → **Комбо: auto-detect + ручной выбор + везде**

---

## References

- `sdd-miw-gift` - Expert profiles, FVI/ИПП концепция
- `sdd-taxlien-swipe-app-swipe-screen` - Beginner vs Advanced modes
- `sdd-taxlien-swipe-app` - Main app architecture

---

## Approval

- [ ] Reviewed by:
- [ ] Approved on:
- [ ] Notes:
